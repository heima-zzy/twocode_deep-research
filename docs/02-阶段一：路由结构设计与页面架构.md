# 阶段一：路由结构设计与页面架构

## 任务1.1：路由结构设计

### 目标
重新设计应用的路由结构，将聊天首页设为根路径，现有深度研究功能迁移到独立路由。

### 当前状态分析
- 当前根路径 `/` 直接展示深度研究界面
- 所有功能集中在单一页面中
- 需要拆分为多个独立页面

### 实施步骤

#### 步骤1：创建新的路由结构
1. 在 `src/app` 目录下创建新的路由目录结构：
   - `src/app/page.tsx` - 新的聊天首页
   - `src/app/research/page.tsx` - 深度研究页面
   - `src/app/chat/page.tsx` - 聊天详情页面（可选）

#### 步骤2：迁移现有深度研究功能
1. 将当前 `src/app/page.tsx` 的内容迁移到 `src/app/research/page.tsx`
2. 保持所有现有组件和功能不变
3. 确保所有导入路径正确

#### 步骤3：创建新的聊天首页
1. 在 `src/app/page.tsx` 中创建新的聊天界面
2. 设计简洁的布局结构
3. 添加到深度研究页面的导航

### 测试方法
1. **路由访问测试**：
   - 访问 `/` 应显示新的聊天首页
   - 访问 `/research` 应显示原有的深度研究界面
   - 所有路由应正常加载，无404错误

2. **功能完整性测试**：
   - 在 `/research` 页面测试所有原有功能
   - 确保深度研究的完整流程正常工作
   - 验证所有设置、历史记录等功能正常

3. **导航测试**：
   - 测试页面间的跳转功能
   - 验证浏览器前进后退按钮正常工作
   - 确保URL状态正确更新

## 任务1.2：页面布局架构设计

### 目标
设计聊天首页的整体布局结构，规划左侧边栏组件架构，实现响应式布局。

### 布局设计原则
1. **移动优先**：优先考虑移动端体验
2. **组件化**：每个功能区域独立组件
3. **响应式**：适配不同屏幕尺寸
4. **一致性**：与现有设计风格保持一致

### 实施步骤

#### 步骤1：创建主布局组件
1. 创建 `src/components/Chat/Layout.tsx` 主布局组件
2. 定义整体的网格布局结构
3. 实现响应式断点处理

#### 步骤2：设计左侧边栏架构
1. 创建 `src/components/Chat/Sidebar.tsx` 边栏组件
2. 规划边栏内容区域：
   - 顶部：新建对话按钮
   - 中部：历史对话列表
   - 底部：设置和知识库入口

#### 步骤3：设计主内容区域
1. 创建 `src/components/Chat/MainContent.tsx` 主内容组件
2. 规划内容区域：
   - 顶部：标题栏
   - 中部：消息列表区域
   - 底部：输入框和深度研究按钮

#### 步骤4：实现响应式布局
1. 定义断点规则：
   - 移动端（<768px）：隐藏侧边栏，全屏显示主内容
   - 平板端（768px-1024px）：可折叠侧边栏
   - 桌面端（>1024px）：固定侧边栏显示

2. 实现侧边栏切换逻辑：
   - 添加汉堡菜单按钮
   - 实现侧边栏显示/隐藏动画
   - 处理遮罩层点击关闭

### 组件架构设计

```
ChatLayout
├── Sidebar
│   ├── NewChatButton
│   ├── ChatHistoryList
│   ├── ResearchHistoryList
│   └── BottomActions
│       ├── KnowledgeButton
│       └── SettingsButton
└── MainContent
    ├── Header
    ├── MessageList
    └── InputArea
        ├── ChatInput
        └── DeepResearchButton
```

### 状态管理设计
1. **全局状态**：
   - 侧边栏显示/隐藏状态
   - 当前选中的对话ID
   - 响应式断点状态

2. **本地状态**：
   - 输入框内容
   - 消息发送状态
   - UI交互状态

### 测试方法

1. **布局测试**：
   - 在不同屏幕尺寸下测试布局
   - 验证响应式断点切换正常
   - 检查组件在各种分辨率下的显示效果

2. **交互测试**：
   - 测试侧边栏展开/收起功能
   - 验证移动端汉堡菜单正常工作
   - 测试遮罩层点击关闭功能

3. **兼容性测试**：
   - 在主流浏览器中测试布局
   - 验证CSS Grid和Flexbox支持
   - 测试触摸设备上的交互

4. **性能测试**：
   - 测试布局渲染性能
   - 验证响应式切换的流畅性
   - 检查内存使用情况

### 样式规范

1. **颜色方案**：
   - 继承现有的主题色彩
   - 支持深色/浅色模式切换
   - 保持与深度研究页面的一致性

2. **间距规范**：
   - 使用Tailwind CSS的间距系统
   - 保持8px基础网格对齐
   - 确保触摸友好的最小点击区域

3. **动画效果**：
   - 侧边栏切换使用平滑过渡
   - 消息加载使用淡入效果
   - 按钮交互提供视觉反馈

### 完成标准

1. 所有组件正确渲染，无控制台错误
2. 响应式布局在所有目标设备上正常工作
3. 侧边栏交互功能完全可用
4. 布局性能满足要求（首次渲染<100ms）
5. 通过所有测试用例

### 下一步
完成本阶段后，继续进行阶段二的数据层扩展工作。确保在进入下一阶段前，所有布局和路由功能都已稳定运行。